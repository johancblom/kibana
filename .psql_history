\l
\q
\q
\d
select * from activity;
\q
\d
select * from activity;
\q
\d
select * from activity;
\q
select * from activity;
select * from activity;
select * from activity where type != 'activity log created';
select * from activity where type != 'Activity log created';
\q
select * from activity where ts > '2016-1-8 15:7:43.144000 +0:0:0';
select * from activity where ts > timestamp '2016-1-8 15:7:43.144000 +0:0:0';
select * from activity where ts => timestamp '2016-1-8 15:7:43.144000 +0:0:0';
select * from activity where ts => timestamp '2016-01-08 00:00:00';
\l
\d usageserver
\d
\d activity
select * from activity where ts => to_timestamp('2016-01-08 00:00:00');
select * from activity where ts => to_timestamp(ts) <= DATE '16-01-08 00:00:00';
select * from activity where to_timestamp(ts) <= DATE '16-01-08 00:00:00';
select * from activity where to_timestamp(ts) <= DATE '16-01-08';
select * from activity where to_timestamp(ts) <= DATE '01-01-08';
select * from activity where to_timestamp(ts) <= DATE '01-01-18';
select * from activity where to_timestamp(ts) => DATE '01-01-18';
select * from activity where to_timestamp(ts) >= DATE '01-01-18';
select * from activity where to_timestamp(ts) >= DATE '18-01-18';
select * from activity where to_timestamp(ts) >= DATE '12-01-18';
select * from activity where to_timestamp(ts) >= DATE '12-18-18';
select * from activity where to_timestamp(ts) >= DATE '12-18-18';
select * from activity where to_timestamp(ts) >= DATE '13-18-18';
select * from activity where to_timestamp(ts) >= DATE '12-32-18';
select * from activity where to_timestamp(ts) >= DATE '12-31-18';
select to_timestamp(ts) from activity;
select timestamp from activity;
select ts from activity;
select to_timestamp(ts/1000) from activity;
select * from activity where to_timestamp(ts/1000) >= DATE '12-32-18';
select * from activity where to_timestamp(ts/1000) >= DATE '12-31-18';
select * from activity where to_timestamp(ts/1000) >= DATE '12-31-16';
select * from activity where to_timestamp(ts/1000) >= DATE '12-31-16 12:56:00';
select * from activity where to_timestamp(ts/1000) >= DATE '12-31-16 12:56:00.000';
select * from activity where to_timestamp(ts) > DATE '2016-1-8 15:7:43.144000 +0:0:0';
select * from activity where to_timestamp(ts) > DATE '2016-1-8 15:7:43.144000 +0:0:0';
select * from activity where to_timestamp(ts/1000) > DATE '2016-1-8 15:39:16.728000 +0:0:0';
select * from activity where to_timestamp(ts/1000) > DATE '2016-1-8 15:39:16.728000 +0:0:0';
select * from activity where to_timestamp(ts/1000) > '2016-1-8 15:39:16.728000 +0:0:0'::date;
select * from activity where to_timestamp(ts/1000) > '2016-1-8 15:39:16.728000 +0:0:0'::date;
\q
drop table activity;
\d
drop table schema_version;
\q
\d
select * from activity;
\q
\d
\d activity;
\q
\d
select * from activity;
\q
\d
\q
\d
select * from activity;
select * from schema_version;
select * from schema_version;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
\q
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
\q
select * from activity;
\q
SELECT pg_reload_conf();
\q
\d
select * from activity;
select * from activity where to_timestamp(ts/1000) > '2017-1-12 8:47:0.000000 +0:0:0'::date;
select * from activity where to_timestamp(ts/1000) > '2017-1-11 8:47:0.000000 +0:0:0'::date;
select to_timestamp(ts/1000) from activity;
select to_timestamp(ts/1000) from activity;
\q
select to_timestamp(ts/1000) from activity;
select * from activity;
\q
select * from activity where details !='' and ts > '2017-2-19 17:16:0.143000 + 0:0:0';
\q
\d
select * from activity;
\q
\d
select * from activity;
\q
\d
\d activity
select max(ts) from activity;
\q
\q
\d
select * from activity;
\q
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity;
select * from activity where ts > '2017-06-21 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-21 00:00:00.000'; 
\q
\q
select * from activity where ts > '2017-06-22 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
select * from activity where ts > '2017-06-23 00:00:00.000'; 
\q
\d
select * from activity;
delete from activity;
\q
select * from activity;
\q
select * from activity;
\q
select * from activity;
\q
delete from activity;
\q
select * from activity;
\q
select * from activity;
\q
select * from activity;
\q
select * from activity;
\q
select * from activity;
\q
select * from activity;
\q
select count(*) from activity;
\q
select count(*) from activity;
\q
select * from activity;
\q
open usageserver;
\q
select * from activity;
select * from activity where details like '%areas%';
select * from activity where details like '%area%';
select * from activity where details like '%Area%';
select * from activity where details like '%Area%';
select * from activity where details like '%Area%';
\q
select * from activity where details like '%Area%';
select * from activity where details like '%Area%';
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details) + 6,10) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details) + 6,10) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details) + 10,10) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details) + 10,20) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details) + 20,20) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+20,20) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+20,20) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+6,20) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7,20) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-2) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-2) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-4) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-2) else '' end as areas from activity;
select position(']' in details);
select position(']' in details) from activity;
select position(']' in details), details from activity;
select position(']' in details) - position('Areas' in details), details from activity;
select position(']' in details) - position('Areas' in details), details from activity;
select substr(details, position('Areas' in details), position(']' in details) - position('Areas' in details)), details from activity;
select substr(details, position('Areas' in details), position(']' in details) - position('Areas' in details)) from activity;
select substr(details, position('Areas' in details)+7, position(']' in details) - position('Areas' in details)) from activity;
select substr(details, position('Areas' in details)+7, position(']' in details) - position('Areas' in details)-9) from activity;
select substr(details, position('Areas' in details)+7, position(']' in details) - position('Areas' in details)-7) from activity;
select substr(details, position('Areas' in details)+7, position(']' in details) - position('Areas' in details)-2) from activity;
select substr(details, position('Areas' in details)+7, position(']' in details) - position('Areas' in details)) from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-9) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-2) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-3) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-2) else '' end as areas, details from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-4) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-5) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-6) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-7) else '' end as areas from activity;
select case when type='Perspective Switch'then 'Areas: ' || substr(details, position('Areas' in details)+7, position(']' in details)-position('Areas' in details)-7) else '' end as areas from activity;
\q
select ts from activity;
\q
select * from activity where type='Perspective Switch';
select * from activity where type='Perspective Switch' and user_id = 'xxfa4simko';
select * from activity where type='Perspective Switch' and user_id = 'XXFA4SIMKO';
select * from activity where type='Perspective Switch' and user_id = 'XPTR2CARLS';
select * from activity where type='Perspective Switch' and user_id = 'XPTR2CARLS';
select * from activity where type='Perspective Switch' and user_id = 'XPTR2CARLS';
select lag(ts) from activity where type='Perspective Switch' and user_id = 'XPTR2CARLS';
select lag(ts) over (PARTITION by user_id) from activity where type='Perspective Switch' and user_id = 'XPTR2CARLS';
select diff(ts) over (PARTITION by user_id) from activity where type='Perspective Switch' and user_id = 'XPTR2CARLS';
select t1.ts, t2.ts, (t2.ts - t1.ts) from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts) from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts) from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts) from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts) from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS' and ts > t1.ts) t2;
select t1.ts, t2.ts, (t2.ts - t1.ts) from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts), t1.ROW_NUMBER() from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 crossq join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts), t1.ROW_NUMBER() from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts), t1.ROW_NUMBER() from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts), t1.ROW_NUMBER() from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t1.ts, t2.ts, (t2.ts - t1.ts) from (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t1 cross join (select * from activity where type = 'Perspective Switch' and user_id = 'XPTR2CARLS') t2;
select t.ts - lag(t.ts) over (order by t.ts) as diff from activity t;
select t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' and user_id = 'XPTR2CARLS';
select t.details, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' and user_id = 'XPTR2CARLS';
select t.details, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' and user_id = 'XPTR2CARLS';
select t.details, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' and user_id = 'XPTR2CARLS' and diff < 1000;
select t.details, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' and user_id = 'XPTR2CARLS';
select t.details, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch';
select t.details, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch';
select t.user_id, t.details, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' group by user_id;
select t.user_id, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' group by user_id;
select t.user_id, t.ts, t.ts - lag(t.ts) over (t.user_id order by t.ts) as diff from activity t where type = 'Perspective Switch';
select t.user_id, t.ts, t.ts - lag(t.ts) over (user_id order by t.ts) as diff from activity t where type = 'Perspective Switch';
select t.user_id, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' and user_id = t.user_id;
select t.user_id, t.ts, t.ts - lag(t.ts) over (order by t.ts) as diff from activity t where type = 'Perspective Switch' and user_id = t.user_id;
select t.user_id, t.ts, t.ts - lag(t.ts) over (partition by user_id order by t.ts) as diff from activity t where type = 'Perspective Switch';
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t where type = 'Perspective Switch';
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t;
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t;
\q
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t;
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t;
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t where type = 'Perspective Switch';
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t where type = 'Perspective Switch' and details like '%complexbook%';
select t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t where type = 'Perspective Switch' and details like '%complexbook%';
select t.details, t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t where type = 'Perspective Switch' and details like '%complexbook%';
select t.details, t.user_id, t.type, t.ts, t.ts - lag(t.ts) over (partition by user_id, type order by t.ts) as diff from activity t where type = 'Perspective Switch' and details like '%complexbook%';
\q
\d
\d activity
select t.details, t.user_id, t.type, t.ts, extract(minute from interval(t.ts - lag(t.ts) over (partition by user_id, type order by t.ts))) as diff from activity t where type = 'Perspective Switch' and details like '%complexbook%';
select t.details, t.user_id, t.type, t.ts, extract(minute from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts))) as diff from activity t where type = 'Perspective Switch' and details like '%complexbook%';
select t.details, t.user_id, t.type, t.ts, extract(minute from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts))) as diff from activity t where type = 'Perspective Switch';
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch';
\q
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch';
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwath%';
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%';
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%';
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts;
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts;
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts;
\q
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts;
select * from activity where type = 'Perspective Switch' and user_id = 'XXFA4SIMKO';
select * from activity where type = 'Perspective Switch' and user_id = 'XXFA4SIMKO';
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lag(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
\q
select * from activity where type = 'Perspective Switch' and user_id = 'XXFA4SIMKO';
\q
select * from activity order by ts desc limit 100;
select t.details, t.user_id, t.type, t.ts, extract(epoch from (lead(t.ts) - t.ts over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, extract(epoch from (lead(t.ts) - t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, extract(epoch from (lead(t.ts) - t.ts over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, extract(epoch from (lead(t.ts) - lead(t.ts) over (partition by user_id, type order by t.ts)))/60 as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, abs(extract(epoch from (lead(t.ts) - t.ts over (partition by user_id, type order by t.ts)))/60) as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, abs(extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60) as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, abs(extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60) as diff from activity t where type = 'Perspective Switch' and details like '%marketwatch%' order by ts; 
select t.details, t.user_id, t.type, t.ts, abs(extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60) as diff from activity t where type = 'Perspective Switch' and user_id='XXFA4SIMKO' order by ts; 
select t.details, t.user_id, t.type, t.ts, abs(extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60) as diff from activity t where type = 'Perspective Switch' and user_id='XXFA4SIMKO' order by ts; 
\q
select t.details, t.user_id, t.type, t.ts, abs(extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60) as diff from activity t where type = 'Perspective Switch' and user_id='XXFA4SIMKO' order by ts; 
\q
select t.details, t.user_id, t.type, t.ts, abs(extract(epoch from (t.ts - lead(t.ts) over (partition by user_id, type order by t.ts)))/60) as diff from activity t where type = 'Perspective Switch' and user_id='XXFA4SIMKO' order by ts; 
\q
select * from activity limit 10;
select * from activity limit 10;
select max(timestamp) from activity;
select * from activity limit 10;
select max(ts) from activity;
\q
\d
select * from activity limit 10;
select * from activity limit 10;
select * from activity where ts > '2017-12-10 00:00:00.000';
select * from activity where ts > '2017-12-13 00:00:00.000';
\q
